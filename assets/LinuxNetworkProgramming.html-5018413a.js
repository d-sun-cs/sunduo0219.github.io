import{_ as n,W as s,X as a,a2 as e}from"./framework-3800c176.js";const o={},t=e(`<h1 id="linux-network-programming" tabindex="-1"><a class="header-anchor" href="#linux-network-programming" aria-hidden="true">#</a> Linux Network Programming</h1><h2 id="socket-programming" tabindex="-1"><a class="header-anchor" href="#socket-programming" aria-hidden="true">#</a> Socket Programming</h2><p>Socket:</p><ul><li><p>IP + port</p></li><li><p>Linux implement: 1 file descriptor -&gt; 1 socket --contains--&gt; 2 buffers by core</p><ul><li>sending buffer</li><li>receiving buffer</li></ul></li><li><p>pair sockets in network communication</p><ul><li>sending &lt;-&gt; receiving</li><li>receiving &lt;-&gt; sending</li></ul></li><li><p><code>sockaddr</code>: <code>man 7 ip</code></p><ul><li><p><code>struct sockaddr_in addr;</code></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> <span class="token punctuation">{</span>
    <span class="token class-name">sa_family_t</span> sin_family<span class="token punctuation">;</span> <span class="token comment">/* AF_INET, AF_INET6 */</span>
    <span class="token class-name">in_port_t</span> sin_port<span class="token punctuation">;</span> <span class="token comment">/* NBO port, htons*/</span>
    <span class="token keyword">struct</span> <span class="token class-name">in_addr</span> sin_addr<span class="token punctuation">;</span> <span class="token comment">/* internet address */</span>
<span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token class-name">in_addr</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> s_addr<span class="token punctuation">;</span> <span class="token comment">/* NBO address, inet_pton */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>INADDR_ANY</code>: Get any valid host IP address in system, binary little-endian</p></li><li><p>use:</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code>addr<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token operator">/</span>AF_INET6<span class="token punctuation">;</span>
addr<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dst<span class="token punctuation">;</span>
<span class="token function">inet_pton</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> dst<span class="token punctuation">;</span>
addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">htonl</span><span class="token punctuation">(</span>INADDR_ANY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// key point</span>
<span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sockaddr</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>addr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Why: uniform interface type but use more accurate implementation</p></li></ul></li></ul><p>Network Byte Order:</p><ul><li><p>Little-endian order: Physical storage within computer</p><blockquote><p>Microsoft, Intel</p></blockquote></li><li><p>Big-endian order: TCP/IP network</p><blockquote><p>IBM</p></blockquote></li><li><p>Transformation: little-endian &lt;-&gt; big-endian</p><ul><li>IP <ul><li><code>htonl</code></li><li><code>ntohl</code></li><li><code>inet_pton</code>: Dotted decimal IP (string) --<code>atoi</code>--&gt; <code>int </code> --<code>htol</code>--&gt; NBO IP <ul><li><code>af</code>: <code>AF_INET</code>, <code>AF_INET6</code></li><li><code>const char *src</code>: Dotted decimal IP</li><li><code>void *dst</code>: NBO IP, result argument</li><li>return <ul><li>success: <code>1</code></li><li><code>src</code> not valid exception: <code>0</code></li><li>error: <code>-1</code></li></ul></li></ul></li><li><code>inet_ntop</code><ul><li><code>af</code></li><li><code>const void *src</code>: NBO</li><li><code>char *dst</code>: result argument <ul><li>success: non-NULL</li><li>error: non</li></ul></li><li><code>socklen_t size</code>: size of <code>dst</code></li></ul></li></ul></li><li>Port <ul><li><code>htons</code></li><li><code>ntohs</code></li></ul></li></ul><blockquote><p>h: host to n:network s:short l:long</p></blockquote></li></ul>`,6),i=[t];function c(l,p){return s(),a("div",null,i)}const r=n(o,[["render",c],["__file","LinuxNetworkProgramming.html.vue"]]);export{r as default};
